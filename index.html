<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>DondeJoseito FastFood</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      color: #fff;
      text-align: center;
      background: url('joseito Fast Food_page-0001.jpg') no-repeat center center fixed;
      background-size: cover;
    }
    .menu {
      background: rgba(0,0,0,0.6);
      margin: 20px auto;
      padding: 20px;
      border-radius: 10px;
      max-width: 800px;
    }
    .item {
      border-bottom: 1px solid #ccc;
      padding: 10px;
    }
    .item h3 {
      margin: 0;
      font-size: 1.2em;
    }
    .item p {
      margin: 5px 0;
    }
    .whatsapp-btn {
      display: inline-block;
      margin-top: 10px;
      padding: 8px 12px;
      background: #25D366;
      color: #fff;
      border-radius: 5px;
      text-decoration: none;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>üçî DondeJoseito FastFood</h1>
  <div id="menu" class="menu">Cargando men√∫...</div>

  <script>
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTbg8KB2-y4tvbCW0e7Gf5CgXINL0nYscJRYD8BSavoNc40YZp0XWMF2-L686N0VoPqNIBTECKQqPd5/pub?gid=0&single=true&output=tsv";
    const dolarApi = "https://ve.dolarapi.com/v1/dolares/oficial";

    async function loadMenu() {
      try {
        // Obtener tasa oficial
        const dolarRes = await fetch(dolarApi);
        const dolarData = await dolarRes.json();
        const tasa = dolarData.promedio; // campo "promedio"

        // Obtener hoja TSV
        const res = await fetch(sheetUrl);
        const text = await res.text();
        const rows = text.trim().split("\n").map(r => r.split("\t"));
        const headers = rows[0];
        const data = rows.slice(1);

        const menuDiv = document.getElementById("menu");
        menuDiv.innerHTML = "";

        data.forEach(row => {
          const item = {};
          headers.forEach((h,i) => item[h] = row[i]);

          let precioBs, precioUsd;
          if(item.currency.toUpperCase() === "USD") {
            precioUsd = parseFloat(item.price);
            precioBs = (precioUsd * tasa).toFixed(2);
          } else {
            precioBs = parseFloat(item.price);
            precioUsd = (precioBs / tasa).toFixed(2);
          }

          const div = document.createElement("div");
          div.className = "item";
          div.innerHTML = `
            <h3>${item.name}</h3>
            <p>${item.description}</p>
            <p><strong>${precioUsd} USD</strong> / <strong>${precioBs} Bs</strong></p>
            <p>Categor√≠a: ${item.category}</p>
            <a class="whatsapp-btn" href="https://wa.me/584141234567?text=Quiero%20comprar%20${encodeURIComponent(item.name)}%20(${precioUsd}%20USD)" target="_blank">Comprar por WhatsApp</a>
          `;
          menuDiv.appendChild(div);
        });
      } catch (err) {
        document.getElementById("menu").innerHTML = "Error cargando men√∫ üò¢";
        console.error(err);
      }
    }

    loadMenu();
  </script>
</body>
</html>
